"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[8456],{70575:function(e,t,a){a.d(t,{H:function(){return n},h:function(){return r}});var l=a(94159);const n=l.createContext({adultFilterMode:"hide",isAdult:!1,categories:new Set,setAdultFilterMode:()=>{},categoryMatch:"any",setCategoryMatch:()=>{},sortOrder:"random",setSortOrder:()=>{}}),r=()=>(0,l.useContext)(n)},26225:function(e,t,a){a.d(t,{l:function(){return y}});var l=a(37111),n=a(76051),r=a(12093),s=a(94159),o=a(98074),i=a(62745),c=a(50196),u=a(46975),m=a(47071),d=a(51540),g=a(70575),p=a(55875),E=a(2403),f=a(96332),b=a(93410),v=a(44144);const h=({attachment:e})=>{const t=(0,i.Q)(),[a,l]=(0,s.useState)(t.gifsStartPaused?e.previewURL:e.fileURL),[n,r]=(0,s.useState)(!t.gifsStartPaused),o=(0,c.T)(a,300,1.2);return s.createElement("div",{className:"group relative"},s.createElement("img",{src:o(1),srcSet:`\n                ${o(1)} 1x,\n                ${o(2)} 2x,\n                ${o(3)} 3x,\n            `,alt:e.altText,className:"co-border aspect-[300/250] w-full border-b object-cover"}),e.previewURL!==e.fileURL&&s.createElement(m.I,{isPlaying:n,showPlay:e.previewURL!==e.fileURL,extraClasses:"absolute bottom-3 right-3 w-12",onPlay:()=>{r(!0),l(e.fileURL)},onPause:()=>{r(!1),l(e.previewURL)}}))},x=({listing:e})=>{const t=(0,s.useContext)(v.j);return s.createElement(p.v,{as:"div",className:"relative h-6"},s.createElement(p.v.Button,{className:"co-action-button cursor-pointer text-sm font-bold hover:underline"},s.createElement(f.Z,{className:"h-6 w-6 transition-transform ui-open:rotate-90"})),s.createElement(p.v.Items,{className:"co-meatball-items absolute right-0 top-8 z-30 flex min-w-max flex-col divide-y rounded-lg p-3  focus:!outline-none"},s.createElement(p.v.Item,null,s.createElement(b.X,{disabled:!1,onClick:()=>{t.send({type:"START_REPORT",artistAlleyListingId:e.id})},ItemIcon:E.Z,text:"report"}))))},y=({listing:e,project:t})=>{const a=(0,s.useMemo)((()=>(0,l.Ml)(e.body,new Date,{disableEmbeds:!0,externalLinksInNewTab:!0,hasCohostPlus:!1,renderingContext:"artistAlley"})),[e.body]),n=(0,o.rA)();return s.createElement("div",{"data-theme":n.current,className:"co-themed-box co-artist-alley-listing flex w-full flex-col rounded-lg border"},s.createElement("div",{className:"co-border flex flex-row items-center gap-2 border-b px-2 py-3"},s.createElement(d.t,{project:t,className:"h-8"}),s.createElement("a",{href:r.ZP.public.project.mainAppProfile({projectHandle:t.handle}).toString()},"@",t.handle),s.createElement("div",{className:"flex-1"},"Â "),e.adultContent?s.createElement("span",{className:"co-18-plus rounded-lg p-1 text-xs "},"18+"):null,s.createElement(x,{listing:e})),e.attachment&&s.createElement(h,{attachment:e.attachment}),s.createElement("div",{className:"co-prose prose p-2"},a),s.createElement("div",{className:"mx-2 my-3"},s.createElement(u.k,{as:"a",buttonColor:"",buttonSize:"regular",href:e.cta.link,extraClasses:"co-cta-button",target:"_blank"},e.cta.text)),e.categories.length>0&&s.createElement(w,{tags:e.categories}))},w=({tags:e})=>{const{categories:t}=(0,g.h)(),a=e.filter((e=>""!=e));return a.length?s.createElement("div",{className:"w-full max-w-full p-3"},s.createElement("div",{className:n.tw`co-tags relative w-full overflow-y-hidden break-words leading-none`},s.createElement("div",null,a.map((e=>s.createElement("button",{key:e,className:"mr-2 inline-block text-sm hover:underline "+(t.has(e)?"font-bold":""),onClick:()=>{t.has(e)?t.delete(e):t.add(e)}},"#",e)))))):null}},98915:function(e,t,a){a.r(t),a.d(t,{ArtistAlleyPendingQueuePage:function(){return d},default:function(){return g}});var l=a(71860),n=a(94159),r=a(26225),s=a(12093),o=a(46975),i=a(91045);const c=({listingId:e})=>{const t=l.S.artistAlley.moderator.approveListing.useMutation(),a=l.S.useContext(),[r,s]=(0,n.useState)(!1),c=(0,n.useCallback)((async()=>{await t.mutateAsync({id:e}),await a.artistAlley.moderator.getPendingListings.invalidate(),s(!1)}),[t,e,a.artistAlley.moderator.getPendingListings]),u=(0,n.useCallback)((()=>{s(!0)}),[]);return n.createElement(n.Fragment,null,n.createElement(i.K,{isOpen:r,title:"Approve Listing",body:"Are you sure you want to approve this listing?",confirm:{label:"Approve",color:"green"},cancel:{label:"Cancel",color:"stroke"},onConfirm:c,onCancel:()=>s(!1)}),n.createElement(o.k,{onClick:u,buttonSize:"regular",buttonColor:"green"},"Approve"))},u=({listingId:e})=>{const[t,a]=(0,n.useState)(!1),[r,s]=(0,n.useState)(""),c=l.S.artistAlley.moderator.rejectListing.useMutation(),u=l.S.useContext(),m=(0,n.useCallback)((async()=>{await c.mutateAsync({id:e,rejectReason:r}),await u.artistAlley.moderator.getPendingListings.invalidate(),a(!1)}),[c,e,r,u.artistAlley.moderator.getPendingListings]),d=(0,n.useCallback)((()=>{a(!0)}),[]);return n.createElement(n.Fragment,null,n.createElement(i.K,{isOpen:t,title:"Reject Listing",body:"Are you sure you want to reject this listing?",confirm:{label:"Reject",color:"destructive"},cancel:{label:"Cancel",color:"stroke"},onConfirm:m,onCancel:()=>a(!1)},n.createElement("div",null,n.createElement("label",null,"Reject reason:"," ",n.createElement("input",{type:"text",value:r,onChange:e=>s(e.currentTarget.value)})))),n.createElement(o.k,{onClick:d,buttonSize:"regular",buttonColor:"destructive"},"Reject"))},m=({listing:e,project:t,user:a})=>n.createElement("div",{className:"flex w-full min-w-0 flex-row justify-between gap-4 rounded-lg border border-notBlack p-3"},n.createElement("div",{className:"w-full max-w-[300px]"},n.createElement(r.l,{listing:e,project:t})),n.createElement("div",{className:"prose flex-shrink"},n.createElement("ul",null,n.createElement("li",null,"user: ",a.email," (",n.createElement("a",{href:s.ZP.public.moderation.manageUser({userId:a.userId}).toString()},"manage"),")"),n.createElement("li",null,"project: ",t.handle," (",n.createElement("a",{href:s.ZP.public.moderation.manageProject({projectHandle:t.handle}).toString()},"manage"),")"),n.createElement("li",null,"listing: ",e.id),n.createElement("li",null,"created at: ",e.createdAt),n.createElement("li",null,"num weeks: ",e.numWeeks),n.createElement("li",null,"status: ",e.status),n.createElement("li",null,"payment status:"," ",n.createElement("a",{href:`https://dashboard.stripe.com/payments/${e.stripePaymentIntentId}`},e.paymentStatus)),n.createElement("li",null,"notes:",n.createElement("br",null),n.createElement("blockquote",null,e.notes))),n.createElement("div",{className:"flex flex-row gap-2"},n.createElement(c,{listingId:e.id}),n.createElement(u,{listingId:e.id}))));function d(){const{data:e,hasNextPage:t,isLoading:a,fetchNextPage:r}=l.S.artistAlley.moderator.getPendingListings.useInfiniteQuery({},{suspense:!0,getNextPageParam:e=>e.nextCursor}),s=(0,n.useMemo)((()=>e?.pages.flatMap((e=>e.listings))??[]),[e?.pages]),i=(0,n.useMemo)((()=>{const t=new Map;return e?.pages.forEach((e=>{Object.values(e.relevantProjects).forEach((e=>{t.set(e.projectId,e)}))})),t}),[e?.pages]),c=(0,n.useMemo)((()=>{const t=new Map;return e?.pages.forEach((e=>{Object.values(e.relevantUsers).forEach((e=>{t.set(e.userId,e)}))})),t}),[e?.pages]);return n.createElement("div",{className:"bg-notWhite p-3 text-notBlack"},n.createElement("h1",{className:"mb-4 text-4xl font-bold"},"pending listings"),n.createElement("div",{className:"flex flex-col gap-4"},s.map((e=>n.createElement(m,{listing:e,key:e.id,project:i.get(e.projectId),user:c.get(e.userId)}))),n.createElement(o.k,{onClick:async()=>{await r()},disabled:!t||a,buttonSize:"regular",buttonColor:"cherry"},"load more")))}var g=d}}]);
//# sourceMappingURL=client-preact-components-pages-moderation-artist-alley-pending-queue.90bdf8c96c24bba130e9.js.map