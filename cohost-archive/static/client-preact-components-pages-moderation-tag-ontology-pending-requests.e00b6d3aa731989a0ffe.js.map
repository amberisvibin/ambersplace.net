{"version":3,"file":"client-preact-components-pages-moderation-tag-ontology-pending-requests.e00b6d3aa731989a0ffe.js","mappings":"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","sources":["webpack:///./preact/components/pages/moderation/tag-ontology/pending-requests.tsx"],"sourcesContent":["import React, { FunctionComponent } from \"react\";\nimport { trpc } from \"@/client/lib/trpc\";\nimport { TagRelationRequestData } from \"@/shared/types/tags\";\nimport { BasicButton } from \"../../../elements/basic-button\";\nimport sitemap from \"@/shared/sitemap\";\n\nexport const TagOntologyPendingRequestsPage: FunctionComponent = (props) => {\n    const requests =\n        trpc.moderation.tag.getPendingRelationRequests.useInfiniteQuery(\n            {},\n            {\n                suspense: true,\n                getNextPageParam: (lastPage) => lastPage.nextCursor,\n            }\n        );\n    const createSynonym = trpc.moderation.tag.createSynonym.useMutation();\n    const createRelation = trpc.moderation.tag.createRelation.useMutation();\n    const dismissRelationRequest =\n        trpc.moderation.tag.dismissRelationRequest.useMutation();\n    const pages = requests.data?.pages ?? [];\n\n    function submitAcceptRequestAsSynonym(\n        relationRequest: TagRelationRequestData,\n        invert: boolean\n    ): boolean {\n        createSynonym.mutate({\n            primarySynonymId: invert\n                ? relationRequest.tagHigh.tagId\n                : relationRequest.tagLow.tagId,\n            otherTagId: invert\n                ? relationRequest.tagLow.tagId\n                : relationRequest.tagHigh.tagId,\n            fromRelationRequestId: relationRequest.requestId,\n        });\n\n        location.reload();\n\n        return true;\n    }\n\n    function submitAcceptRequestAsRelated(\n        relationRequest: TagRelationRequestData\n    ): boolean {\n        createRelation.mutate({\n            tagIdA: relationRequest.tagLow.tagId,\n            tagIdB: relationRequest.tagHigh.tagId,\n            fromRelationRequestId: relationRequest.requestId,\n        });\n\n        location.reload();\n\n        return true;\n    }\n\n    function submitDismissRelationRequest(\n        relationRequest: TagRelationRequestData\n    ): boolean {\n        dismissRelationRequest.mutate({\n            relationRequestId: relationRequest.requestId,\n        });\n\n        location.reload();\n\n        return true;\n    }\n\n    return (\n        <div\n            className=\"cohost-shadow-light dark:cohost-shadow-dark container\n                mx-auto mt-12 flex flex-col gap-4 rounded-lg bg-notWhite p-3 text-notBlack\"\n        >\n            <h1 className=\"text-4xl\">manage pending relation requests</h1>\n\n            <table>\n                {pages.map((page) => (\n                    <>\n                        {page.requests.map((req) => (\n                            <>\n                                <div\n                                    className=\"flex flex-row\"\n                                    key={`row-${req.requestId}`}\n                                >\n                                    <div className=\"flex flex-1 flex-col\">\n                                        <div className=\"text-xl\">\n                                            {\"\\u24B6 \"}\n                                            <a\n                                                className=\"text-cherry underline\"\n                                                href={sitemap.public\n                                                    .tags({\n                                                        tagSlug:\n                                                            req.tagLow.content,\n                                                    })\n                                                    .toString()}\n                                            >\n                                                #{req.tagLow.content}\n                                            </a>\n                                            {\" \\u2194 \\u24B7 \"}\n                                            <a\n                                                className=\"text-cherry underline\"\n                                                href={sitemap.public\n                                                    .tags({\n                                                        tagSlug:\n                                                            req.tagHigh.content,\n                                                    })\n                                                    .toString()}\n                                            >\n                                                #{req.tagHigh.content}\n                                            </a>\n                                        </div>\n                                        <div>\n                                            submitting user:{\" \"}\n                                            <a\n                                                href={sitemap.public.moderation\n                                                    .manageUser({\n                                                        userId: req.fromUser\n                                                            .userId,\n                                                    })\n                                                    .toString()}\n                                            >\n                                                {req.fromUser.email}\n                                            </a>{\" \"}\n                                            (@{req.fromUser.selfProjectHandle})\n                                        </div>\n                                        <div>notes: {req.notes}</div>\n                                    </div>\n                                    <div className=\"flex flex-col gap-2\">\n                                        <form\n                                            onSubmit={() =>\n                                                submitAcceptRequestAsSynonym(\n                                                    req,\n                                                    false\n                                                )\n                                            }\n                                        >\n                                            <BasicButton\n                                                type=\"submit\"\n                                                buttonSize=\"regular\"\n                                                buttonColor=\"cherry\"\n                                            >\n                                                add &#x24B6; as synonym of\n                                                &#x24B7;\n                                            </BasicButton>\n                                        </form>\n                                        <form\n                                            onSubmit={() =>\n                                                submitAcceptRequestAsSynonym(\n                                                    req,\n                                                    true\n                                                )\n                                            }\n                                        >\n                                            <BasicButton\n                                                type=\"submit\"\n                                                buttonSize=\"regular\"\n                                                buttonColor=\"cherry\"\n                                            >\n                                                add &#x24B7; as synonym of\n                                                &#x24B6;\n                                            </BasicButton>\n                                        </form>\n                                        <form\n                                            onSubmit={() =>\n                                                submitAcceptRequestAsRelated(\n                                                    req\n                                                )\n                                            }\n                                        >\n                                            <BasicButton\n                                                type=\"submit\"\n                                                buttonSize=\"regular\"\n                                                buttonColor=\"cherry\"\n                                            >\n                                                add as related\n                                            </BasicButton>\n                                        </form>\n                                        <form\n                                            onSubmit={() =>\n                                                submitDismissRelationRequest(\n                                                    req\n                                                )\n                                            }\n                                        >\n                                            <BasicButton\n                                                type=\"submit\"\n                                                buttonSize=\"regular\"\n                                                buttonColor=\"cherry\"\n                                            >\n                                                ignore\n                                            </BasicButton>\n                                        </form>\n                                    </div>\n                                </div>\n                                <hr\n                                    className=\"my-3\"\n                                    key={`hr-${req.requestId}`}\n                                />\n                            </>\n                        ))}\n                    </>\n                ))}\n            </table>\n        </div>\n    );\n};\n\nexport default TagOntologyPendingRequestsPage;\n"],"names":["TagOntologyPendingRequestsPage","props","requests","trpc","suspense","getNextPageParam","lastPage","nextCursor","createSynonym","createRelation","dismissRelationRequest","pages","data","submitAcceptRequestAsSynonym","relationRequest","invert","mutate","primarySynonymId","tagHigh","tagId","tagLow","otherTagId","fromRelationRequestId","requestId","location","reload","React","className","map","page","req","key","href","sitemap","tagSlug","content","toString","userId","fromUser","email","selfProjectHandle","notes","onSubmit","BasicButton","type","buttonSize","buttonColor","submitAcceptRequestAsRelated","tagIdA","tagIdB","submitDismissRelationRequest","relationRequestId"],"sourceRoot":""}