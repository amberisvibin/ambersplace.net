{"version":3,"file":"preact-components-pages-artist-alley-owner-manage-listings.eb878587ac2878d2a1ed.js","mappings":"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","sources":["webpack:///./preact/components/artist-alley/artist-alley-filter-provider.tsx","webpack:///./preact/components/artist-alley/artist-alley-listing.tsx","webpack:///../node_modules/.pnpm/@heroicons+react@2.0.13_react@18.0.0/node_modules/@heroicons/react/20/solid/esm/ClockIcon.js","webpack:///../node_modules/.pnpm/@heroicons+react@2.0.13_react@18.0.0/node_modules/@heroicons/react/20/solid/esm/CheckCircleIcon.js","webpack:///../node_modules/.pnpm/@heroicons+react@2.0.13_react@18.0.0/node_modules/@heroicons/react/20/solid/esm/XCircleIcon.js","webpack:///../node_modules/.pnpm/@heroicons+react@2.0.13_react@18.0.0/node_modules/@heroicons/react/20/solid/esm/QuestionMarkCircleIcon.js","webpack:///./preact/components/artist-alley/artist-alley-owner-listing.tsx","webpack:///./preact/components/pages/artist-alley/owner-manage-listings.tsx"],"sourcesContent":["import { CategoryMatch, SortOrder } from \"@/shared/api-types/artist-alley-v1\";\nimport { ArtistAlleyAdultDisplayMode } from \"@/shared/types/artist-alley\";\nimport React, { useContext } from \"react\";\n\nexport const ArtistAlleyFilterProvider = React.createContext<{\n    adultFilterMode: ArtistAlleyAdultDisplayMode;\n    isAdult: boolean;\n    categories: Set<string>;\n    setAdultFilterMode: (mode: ArtistAlleyAdultDisplayMode) => void;\n    categoryMatch: CategoryMatch;\n    setCategoryMatch: (mode: CategoryMatch) => void;\n    sortOrder: SortOrder;\n    setSortOrder: (order: SortOrder) => void;\n}>({\n    adultFilterMode: \"hide\",\n    isAdult: false,\n    categories: new Set(),\n    setAdultFilterMode: () => {},\n    categoryMatch: \"any\",\n    setCategoryMatch: () => {},\n    sortOrder: \"random\",\n    setSortOrder: () => {},\n});\n\nexport const useArtistAlleyFilters = () => {\n    return useContext(ArtistAlleyFilterProvider);\n};\n","import { renderMarkdownReactNoHTML } from \"@/client/lib/markdown/other-rendering\";\nimport { tw } from \"@/client/lib/tw-tagged-literal\";\nimport sitemap from \"@/shared/sitemap\";\nimport {\n    ArtistAlleyWireAttachment,\n    WireArtistAlley,\n} from \"@/shared/types/artist-alley\";\nimport { WireProjectModel } from \"@/shared/types/projects\";\nimport React, { useContext, useMemo, useState } from \"react\";\nimport { useDynamicTheme } from \"../../hooks/dynamic-theme\";\nimport { useDisplayPrefs } from \"../../hooks/use-display-prefs\";\nimport { useImageOptimizer } from \"../../hooks/use-image-optimizer\";\nimport { BasicButton } from \"../elements/basic-button\";\nimport { PlayPauseButton } from \"../elements/play-pause-button\";\nimport { ProjectAvatar } from \"../partials/project-avatar\";\nimport { useArtistAlleyFilters } from \"./artist-alley-filter-provider\";\nimport { Menu } from \"@headlessui/react\";\nimport {\n    EyeIcon as EyeIconOutline,\n    EyeSlashIcon as EyeSlashIconOutline,\n    ShareIcon,\n    ShieldExclamationIcon as ShieldExclamationIconOutline,\n    TrashIcon as TrashIconOutline,\n} from \"@heroicons/react/24/outline\";\nimport {\n    ArrowUturnLeftIcon,\n    EllipsisHorizontalIcon,\n} from \"@heroicons/react/24/solid\";\nimport { MeatballMenuItem } from \"../elements/meatball-menu-item\";\nimport { ReportingUIContext } from \"@/client/reporting/machine\";\n\nconst ASPECT_RATIO = 300 / 250;\n\nconst ArtistAlleyAttachment: React.FC<{\n    attachment: ArtistAlleyWireAttachment;\n}> = ({ attachment }) => {\n    const displayPrefs = useDisplayPrefs();\n    const [src, setSrc] = useState(\n        displayPrefs.gifsStartPaused\n            ? attachment.previewURL\n            : attachment.fileURL\n    );\n    const [isPlaying, setIsPlaying] = useState(!displayPrefs.gifsStartPaused);\n\n    const srcWithDpr = useImageOptimizer(src, 300, ASPECT_RATIO);\n\n    const handlePause = () => {\n        setIsPlaying(false);\n        setSrc(attachment.previewURL);\n    };\n\n    const handlePlay = () => {\n        setIsPlaying(true);\n        setSrc(attachment.fileURL);\n    };\n\n    return (\n        <div className=\"group relative\">\n            <img\n                src={srcWithDpr(1)}\n                srcSet={`\n                ${srcWithDpr(1)} 1x,\n                ${srcWithDpr(2)} 2x,\n                ${srcWithDpr(3)} 3x,\n            `}\n                alt={attachment.altText}\n                className=\"co-border aspect-[300/250] w-full border-b object-cover\"\n            />\n\n            {attachment.previewURL !== attachment.fileURL && (\n                <PlayPauseButton\n                    isPlaying={isPlaying}\n                    showPlay={attachment.previewURL !== attachment.fileURL}\n                    extraClasses=\"absolute bottom-3 right-3 w-12\"\n                    onPlay={handlePlay}\n                    onPause={handlePause}\n                />\n            )}\n        </div>\n    );\n};\n\nconst ArtistAlleyMeatballMenu: React.FC<{ listing: WireArtistAlley }> = ({\n    listing,\n}) => {\n    const reportingUIContext = useContext(ReportingUIContext);\n\n    return (\n        // explicit height is required to vertically align the\n        // meatballs with the rest of the action buttons\n        <Menu as=\"div\" className=\"relative h-6\">\n            <Menu.Button className=\"co-action-button cursor-pointer text-sm font-bold hover:underline\">\n                <EllipsisHorizontalIcon className=\"h-6 w-6 transition-transform ui-open:rotate-90\" />\n            </Menu.Button>\n\n            <Menu.Items className=\"co-meatball-items absolute right-0 top-8 z-30 flex min-w-max flex-col divide-y rounded-lg p-3  focus:!outline-none\">\n                <Menu.Item>\n                    <MeatballMenuItem\n                        disabled={false}\n                        onClick={() => {\n                            reportingUIContext.send({\n                                type: \"START_REPORT\",\n                                artistAlleyListingId: listing.id,\n                            });\n                        }}\n                        ItemIcon={ShieldExclamationIconOutline}\n                        text=\"report\"\n                    />\n                </Menu.Item>\n            </Menu.Items>\n        </Menu>\n    );\n};\n\nexport const ArtistAlleyListing: React.FC<{\n    listing: WireArtistAlley;\n    project: WireProjectModel;\n}> = ({ listing, project }) => {\n    const rendered = useMemo(() => {\n        return renderMarkdownReactNoHTML(listing.body, new Date(), {\n            disableEmbeds: true,\n            externalLinksInNewTab: true,\n            hasCohostPlus: false,\n            renderingContext: \"artistAlley\",\n        });\n    }, [listing.body]);\n\n    const theme = useDynamicTheme();\n\n    return (\n        <div\n            data-theme={theme.current}\n            className=\"co-themed-box co-artist-alley-listing flex w-full flex-col rounded-lg border\"\n        >\n            <div className=\"co-border flex flex-row items-center gap-2 border-b px-2 py-3\">\n                <ProjectAvatar project={project} className=\"h-8\" />\n                <a\n                    href={sitemap.public.project\n                        .mainAppProfile({ projectHandle: project.handle })\n                        .toString()}\n                >\n                    @{project.handle}\n                </a>\n                <div className=\"flex-1\">&nbsp;</div>\n                {listing.adultContent ? (\n                    <span className=\"co-18-plus rounded-lg p-1 text-xs \">\n                        18+\n                    </span>\n                ) : null}\n                <ArtistAlleyMeatballMenu listing={listing} />\n            </div>\n            {listing.attachment && (\n                <ArtistAlleyAttachment attachment={listing.attachment} />\n            )}\n            <div className=\"co-prose prose p-2\">{rendered}</div>\n\n            <div className=\"mx-2 my-3\">\n                <BasicButton\n                    as=\"a\"\n                    buttonColor=\"\"\n                    buttonSize=\"regular\"\n                    href={listing.cta.link}\n                    extraClasses=\"co-cta-button\"\n                    target=\"_blank\"\n                >\n                    {listing.cta.text}\n                </BasicButton>\n            </div>\n\n            {listing.categories.length > 0 && (\n                <ListingTags tags={listing.categories} />\n            )}\n        </div>\n    );\n};\n\nconst ListingTags: React.FC<{ tags: string[] }> = ({ tags }) => {\n    const { categories } = useArtistAlleyFilters();\n    const filteredTags = tags.filter((tag) => tag != \"\");\n\n    return filteredTags.length ? (\n        <div className=\"w-full max-w-full p-3\">\n            <div\n                className={tw`co-tags relative w-full overflow-y-hidden break-words leading-none`}\n            >\n                <div>\n                    {filteredTags.map((tag) => (\n                        <button\n                            key={tag}\n                            className={`mr-2 inline-block text-sm hover:underline ${\n                                // bold currently filtered tags\n                                categories.has(tag) ? \"font-bold\" : \"\"\n                            }`}\n                            onClick={() => {\n                                categories.has(tag)\n                                    ? categories.delete(tag)\n                                    : categories.add(tag);\n                            }}\n                        >\n                            #{tag}\n                        </button>\n                    ))}\n                </div>\n            </div>\n        </div>\n    ) : null;\n};\n","import * as React from \"react\";\n\nfunction ClockIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    viewBox: \"0 0 20 20\",\n    fill: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    d: \"M10 18a8 8 0 100-16 8 8 0 000 16zm.75-13a.75.75 0 00-1.5 0v5c0 .414.336.75.75.75h4a.75.75 0 000-1.5h-3.25V5z\",\n    clipRule: \"evenodd\"\n  }));\n}\n\nconst ForwardRef = React.forwardRef(ClockIcon);\nexport default ForwardRef;","import * as React from \"react\";\n\nfunction CheckCircleIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    viewBox: \"0 0 20 20\",\n    fill: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    d: \"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z\",\n    clipRule: \"evenodd\"\n  }));\n}\n\nconst ForwardRef = React.forwardRef(CheckCircleIcon);\nexport default ForwardRef;","import * as React from \"react\";\n\nfunction XCircleIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    viewBox: \"0 0 20 20\",\n    fill: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    d: \"M10 18a8 8 0 100-16 8 8 0 000 16zM8.28 7.22a.75.75 0 00-1.06 1.06L8.94 10l-1.72 1.72a.75.75 0 101.06 1.06L10 11.06l1.72 1.72a.75.75 0 101.06-1.06L11.06 10l1.72-1.72a.75.75 0 00-1.06-1.06L10 8.94 8.28 7.22z\",\n    clipRule: \"evenodd\"\n  }));\n}\n\nconst ForwardRef = React.forwardRef(XCircleIcon);\nexport default ForwardRef;","import * as React from \"react\";\n\nfunction QuestionMarkCircleIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    viewBox: \"0 0 20 20\",\n    fill: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    d: \"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM8.94 6.94a.75.75 0 11-1.061-1.061 3 3 0 112.871 5.026v.345a.75.75 0 01-1.5 0v-.5c0-.72.57-1.172 1.081-1.287A1.5 1.5 0 108.94 6.94zM10 15a1 1 0 100-2 1 1 0 000 2z\",\n    clipRule: \"evenodd\"\n  }));\n}\n\nconst ForwardRef = React.forwardRef(QuestionMarkCircleIcon);\nexport default ForwardRef;","import {\n    ArtistAlleyApprovalStatus,\n    OwnerWireArtistAlley,\n} from \"@/shared/types/artist-alley\";\nimport { WireProjectModel } from \"@/shared/types/projects\";\nimport React from \"react\";\nimport { ArtistAlleyListing } from \"./artist-alley-listing\";\nimport { DateTime } from \"luxon\";\nimport {\n    CheckCircleIcon,\n    XCircleIcon,\n    QuestionMarkCircleIcon,\n    ClockIcon,\n} from \"@heroicons/react/20/solid\";\n\ntype ChipStatus = ArtistAlleyApprovalStatus | \"expired\";\nconst ApprovalChip: React.FC<{ status: ChipStatus }> = ({ status }) => {\n    const Icon =\n        status === \"expired\"\n            ? ClockIcon\n            : status === \"approved\"\n            ? CheckCircleIcon\n            : status === \"rejected\"\n            ? XCircleIcon\n            : QuestionMarkCircleIcon;\n    return (\n        <span\n            className={`block max-w-max rounded-lg px-3 py-2 ${\n                status === \"expired\"\n                    ? \"bg-gray-300 text-notBlack\"\n                    : status === \"approved\"\n                    ? \"bg-green-600 text-notWhite contrast-more:bg-green-700\"\n                    : status === \"pending\"\n                    ? \"bg-longan text-notBlack\"\n                    : \"bg-red-600 text-notWhite contrast-more:bg-red-700\"\n            }`}\n        >\n            <Icon className=\"mr-2 inline-block h-4 w-4\" />\n            {status}\n        </span>\n    );\n};\n\nexport const ArtistAlleyOwnerListing: React.FC<{\n    listing: OwnerWireArtistAlley;\n    project: WireProjectModel;\n}> = ({ listing, project }) => {\n    const hasExpired =\n        listing.status === \"approved\" &&\n        new Date(listing.expiresAt) < new Date();\n    const effectiveStatus: ChipStatus = hasExpired ? \"expired\" : listing.status;\n\n    return (\n        <div className=\"flex w-full min-w-0 flex-row flex-wrap justify-between gap-4 \">\n            <div className=\"flex-shrink space-y-3\">\n                <ApprovalChip status={effectiveStatus} />\n                <div>\n                    <ul className=\"space-y-3\">\n                        <li>\n                            <span className=\"font-bold\">purchase date:</span>{\" \"}\n                            {DateTime.fromISO(listing.createdAt).toLocaleString(\n                                DateTime.DATETIME_FULL\n                            )}\n                        </li>\n                        <li>\n                            <span className=\"font-bold\">weeks purchased:</span>{\" \"}\n                            {listing.numWeeks}\n                        </li>\n                        {listing.status === \"approved\" && (\n                            <li>\n                                <span className=\"font-bold\">end date:</span>{\" \"}\n                                {DateTime.fromISO(\n                                    listing.expiresAt\n                                ).toLocaleString(DateTime.DATETIME_FULL)}\n                            </li>\n                        )}\n                        {listing.receiptUrl && (\n                            <li>\n                                <a\n                                    href={listing.receiptUrl}\n                                    rel=\"noopener\"\n                                    target=\"_blank\"\n                                    className=\"font-bold underline\"\n                                >\n                                    view receipt\n                                </a>\n                            </li>\n                        )}\n                        {listing.notes && (\n                            <li>\n                                <span className=\"font-bold\">\n                                    submission notes:\n                                </span>\n                                <br />\n                                <div className=\"co-prose prose mt-2\">\n                                    <blockquote>{listing.notes}</blockquote>\n                                </div>\n                            </li>\n                        )}\n                        {listing.rejectReason && (\n                            <li>\n                                <span className=\"font-bold\">\n                                    rejection reason:\n                                </span>\n                                <br />\n                                <div className=\"co-prose prose mt-2\">\n                                    <blockquote>\n                                        {listing.rejectReason}\n                                    </blockquote>\n                                </div>\n                            </li>\n                        )}\n                    </ul>\n                </div>\n            </div>\n            <div className=\"w-full max-w-[300px] basis-[300px]\">\n                <ArtistAlleyListing listing={listing} project={project} />\n            </div>\n        </div>\n    );\n};\n","import { trpc } from \"@/client/lib/trpc\";\nimport { useRequiresLogin } from \"@/client/preact/providers/user-info-provider\";\nimport React, { useMemo } from \"react\";\nimport { SidebarMenu } from \"../../sidebar-menu\";\nimport { OwnerWireArtistAlley } from \"@/shared/types/artist-alley\";\nimport { ArtistAlleyOwnerListing } from \"../../artist-alley/artist-alley-owner-listing\";\nimport { ProjectId } from \"@/shared/types/ids\";\nimport { WireProjectModel } from \"@/shared/types/projects\";\nimport { isDefined } from \"@/shared/util/filter-null-undefined\";\nimport { BasicButton } from \"../../elements/basic-button\";\nimport sitemap from \"@/shared/sitemap\";\nimport { useDynamicTheme } from \"@/client/preact/hooks/dynamic-theme\";\n\nexport const ArtistAlleyOwnerListingsPage: React.FC = () => {\n    useRequiresLogin();\n\n    const [{ pages }, { hasNextPage, fetchNextPage, isFetching }] =\n        trpc.artistAlley.getOwnerListings.useSuspenseInfiniteQuery(\n            {},\n            {\n                getNextPageParam: (lastPage) => lastPage.nextCursor,\n                refetchOnMount: false,\n                refetchOnWindowFocus: false,\n            }\n        );\n\n    const flattenedListings = useMemo(() => {\n        return pages.flatMap((page) => page.listings) ?? [];\n    }, [pages]);\n\n    const flattenedProjects = useMemo<Map<ProjectId, WireProjectModel>>(() => {\n        const projects = new Map<ProjectId, WireProjectModel>();\n        pages.forEach((page) => {\n            Object.values(page.relevantProjects).forEach((project) => {\n                projects.set(project.projectId, project);\n            });\n        });\n        return projects;\n    }, [pages]);\n\n    const combinedListings = useMemo(() => {\n        const val = flattenedListings\n            .map<\n                | { listing: OwnerWireArtistAlley; project: WireProjectModel }\n                | undefined\n            >((listing) => {\n                const project = flattenedProjects.get(listing.projectId);\n                if (!project) return undefined;\n                return {\n                    listing,\n                    project,\n                };\n            })\n            .filter(isDefined);\n\n        return val;\n    }, [flattenedListings, flattenedProjects]);\n\n    const theme = useDynamicTheme();\n\n    return (\n        <main className=\"w-full pt-16\">\n            <div className=\"container mx-auto grid grid-cols-1 gap-16 lg:grid-cols-4\">\n                <SidebarMenu />\n                <section className=\" col-span-1 flex flex-col gap-12 lg:col-span-2\">\n                    <div\n                        className=\"co-themed-box co-settings rounded-lg p-3\"\n                        data-theme={theme.current}\n                    >\n                        <h1 className=\"co-settings-header\">\n                            manage your listings\n                        </h1>\n                        <hr className=\"mt-6\" />\n                        <div className=\"my-6 flex flex-col space-y-3\">\n                            {combinedListings?.map((listing) => (\n                                <React.Fragment key={listing.listing.id}>\n                                    <ArtistAlleyOwnerListing\n                                        listing={listing.listing}\n                                        project={listing.project}\n                                    />\n                                    <hr />\n                                </React.Fragment>\n                            ))}\n                        </div>\n                        <BasicButton\n                            as=\"button\"\n                            buttonColor=\"theme-sensitive-1\"\n                            buttonSize=\"regular\"\n                            disabled={isFetching || !hasNextPage}\n                            onClick={() => fetchNextPage()}\n                        >\n                            {isFetching\n                                ? \"loading...\"\n                                : hasNextPage\n                                ? \"load more\"\n                                : \"no more listings\"}\n                        </BasicButton>\n                    </div>\n                </section>\n            </div>\n        </main>\n    );\n};\n\nexport default ArtistAlleyOwnerListingsPage;\n"],"names":["ArtistAlleyFilterProvider","React","adultFilterMode","isAdult","categories","Set","setAdultFilterMode","categoryMatch","setCategoryMatch","sortOrder","setSortOrder","useArtistAlleyFilters","useContext","ArtistAlleyAttachment","attachment","displayPrefs","useDisplayPrefs","src","setSrc","useState","gifsStartPaused","previewURL","fileURL","isPlaying","setIsPlaying","srcWithDpr","useImageOptimizer","className","srcSet","alt","altText","PlayPauseButton","showPlay","extraClasses","onPlay","handlePlay","onPause","handlePause","ArtistAlleyMeatballMenu","listing","reportingUIContext","ReportingUIContext","Menu","as","EllipsisHorizontalIcon","MeatballMenuItem","disabled","onClick","send","type","artistAlleyListingId","id","ItemIcon","ShieldExclamationIconOutline","text","ArtistAlleyListing","project","rendered","useMemo","renderMarkdownReactNoHTML","body","Date","disableEmbeds","externalLinksInNewTab","hasCohostPlus","renderingContext","theme","useDynamicTheme","current","ProjectAvatar","href","sitemap","projectHandle","handle","toString","adultContent","BasicButton","buttonColor","buttonSize","cta","link","target","length","ListingTags","tags","filteredTags","filter","tag","tw","map","key","has","delete","add","title","titleId","props","svgRef","Object","assign","xmlns","viewBox","fill","ref","fillRule","d","clipRule","ApprovalChip","status","Icon","ClockIcon","CheckCircleIcon","XCircleIcon","QuestionMarkCircleIcon","ArtistAlleyOwnerListing","effectiveStatus","expiresAt","DateTime","createdAt","toLocaleString","numWeeks","receiptUrl","rel","notes","rejectReason","ArtistAlleyOwnerListingsPage","useRequiresLogin","pages","hasNextPage","fetchNextPage","isFetching","trpc","getNextPageParam","lastPage","nextCursor","refetchOnMount","refetchOnWindowFocus","flattenedListings","flatMap","page","listings","flattenedProjects","projects","Map","forEach","values","relevantProjects","set","projectId","combinedListings","get","isDefined","SidebarMenu"],"sourceRoot":""}