"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[4220],{70575:function(e,t,a){a.d(t,{H:function(){return r},h:function(){return n}});var l=a(94159);const r=l.createContext({adultFilterMode:"hide",isAdult:!1,categories:new Set,setAdultFilterMode:()=>{},categoryMatch:"any",setCategoryMatch:()=>{},sortOrder:"random",setSortOrder:()=>{}}),n=()=>(0,l.useContext)(r)},26225:function(e,t,a){a.d(t,{l:function(){return v}});var l=a(37111),r=a(76051),n=a(12093),s=a(94159),o=a(98074),i=a(62745),c=a(50196),u=a(46975),d=a(47071),m=a(51540),p=a(70575),g=a(55875),f=a(2403),h=a(96332),b=a(93410),y=a(44144);const E=({attachment:e})=>{const t=(0,i.Q)(),[a,l]=(0,s.useState)(t.gifsStartPaused?e.previewURL:e.fileURL),[r,n]=(0,s.useState)(!t.gifsStartPaused),o=(0,c.T)(a,300,1.2);return s.createElement("div",{className:"group relative"},s.createElement("img",{src:o(1),srcSet:`\n                ${o(1)} 1x,\n                ${o(2)} 2x,\n                ${o(3)} 3x,\n            `,alt:e.altText,className:"co-border aspect-[300/250] w-full border-b object-cover"}),e.previewURL!==e.fileURL&&s.createElement(d.I,{isPlaying:r,showPlay:e.previewURL!==e.fileURL,extraClasses:"absolute bottom-3 right-3 w-12",onPlay:()=>{n(!0),l(e.fileURL)},onPause:()=>{n(!1),l(e.previewURL)}}))},x=({listing:e})=>{const t=(0,s.useContext)(y.j);return s.createElement(g.v,{as:"div",className:"relative h-6"},s.createElement(g.v.Button,{className:"co-action-button cursor-pointer text-sm font-bold hover:underline"},s.createElement(h.Z,{className:"h-6 w-6 transition-transform ui-open:rotate-90"})),s.createElement(g.v.Items,{className:"co-meatball-items absolute right-0 top-8 z-30 flex min-w-max flex-col divide-y rounded-lg p-3  focus:!outline-none"},s.createElement(g.v.Item,null,s.createElement(b.X,{disabled:!1,onClick:()=>{t.send({type:"START_REPORT",artistAlleyListingId:e.id})},ItemIcon:f.Z,text:"report"}))))},v=({listing:e,project:t})=>{const a=(0,s.useMemo)((()=>(0,l.Ml)(e.body,new Date,{disableEmbeds:!0,externalLinksInNewTab:!0,hasCohostPlus:!1,renderingContext:"artistAlley"})),[e.body]),r=(0,o.rA)();return s.createElement("div",{"data-theme":r.current,className:"co-themed-box co-artist-alley-listing flex w-full flex-col rounded-lg border"},s.createElement("div",{className:"co-border flex flex-row items-center gap-2 border-b px-2 py-3"},s.createElement(m.t,{project:t,className:"h-8"}),s.createElement("a",{href:n.ZP.public.project.mainAppProfile({projectHandle:t.handle}).toString()},"@",t.handle),s.createElement("div",{className:"flex-1"},"Â "),e.adultContent?s.createElement("span",{className:"co-18-plus rounded-lg p-1 text-xs "},"18+"):null,s.createElement(x,{listing:e})),e.attachment&&s.createElement(E,{attachment:e.attachment}),s.createElement("div",{className:"co-prose prose p-2"},a),s.createElement("div",{className:"mx-2 my-3"},s.createElement(u.k,{as:"a",buttonColor:"",buttonSize:"regular",href:e.cta.link,extraClasses:"co-cta-button",target:"_blank"},e.cta.text)),e.categories.length>0&&s.createElement(w,{tags:e.categories}))},w=({tags:e})=>{const{categories:t}=(0,p.h)(),a=e.filter((e=>""!=e));return a.length?s.createElement("div",{className:"w-full max-w-full p-3"},s.createElement("div",{className:r.tw`co-tags relative w-full overflow-y-hidden break-words leading-none`},s.createElement("div",null,a.map((e=>s.createElement("button",{key:e,className:"mr-2 inline-block text-sm hover:underline "+(t.has(e)?"font-bold":""),onClick:()=>{t.has(e)?t.delete(e):t.add(e)}},"#",e)))))):null}},44346:function(e,t,a){a.r(t),a.d(t,{ArtistAlleyPage:function(){return T},default:function(){return D}});var l=a(71860),r=a(98074),n=a(62745),s=a(94159);const o=(...e)=>{const[t,a]=(0,s.useState)(...e),[l,r]=(0,s.useTransition)();return[t,e=>{r((()=>{a(e)}))}]};var i=a(40196),c=a(12093),u=a(6285),d=a(89109);const m=u.z.enum(["approved","pending","rejected"]),p=u.z.enum(["paid","unpaid","refunded"]),g=(u.z.object({altText:u.z.string(),attachmentFilename:u.z.string(),ip:u.z.string()}),u.z.object({altText:u.z.string(),previewURL:u.z.string().url(),fileURL:u.z.string().url()})),f=(u.z.enum(["hide","include","only"]),u.z.object({id:d.y1,projectId:d.G9,expiresAt:d.iV,createdAt:d.iV,body:u.z.string(),cta:u.z.object({link:u.z.string().url(),text:u.z.string()}),attachment:g.nullable(),categories:u.z.array(u.z.string()),adultContent:u.z.boolean()}));f.extend({userId:d.Et,status:m,paymentStatus:p,stripeCheckoutSessionId:u.z.string().nullable(),stripePaymentIntentId:u.z.string().nullable(),rejectReason:u.z.string().nullable(),numWeeks:u.z.number().int(),notes:u.z.string().nullable()}),f.extend({userId:d.Et,status:m,paymentStatus:p,rejectReason:u.z.string().nullable(),numWeeks:u.z.number().int(),notes:u.z.string().nullable(),receiptUrl:u.z.string().url().nullable()});var h=a(15867),b=a(70769),y=a(49750),E=a(38746),x=a(95024),v=a(90275),w=a(59134),N=a(62866),k=a(28060),C=a(70575),z=a(76051),A=a(58397),S=a(60669),I=a(87239),M=a(56797),j=a(46975),L=a(8227);const P=({tabs:e})=>s.createElement("ul",{className:"co-multi-button mx-auto my-2 flex w-auto max-w-fit flex-row items-center justify-evenly overflow-y-auto whitespace-nowrap rounded-lg"},e.map((e=>s.createElement("li",{key:`${e.label}`,className:"co-multi-button px-3 py-2 text-center text-sm first-of-type:rounded-l-lg last-of-type:rounded-r-lg "+(e.active?"co-active rounded-lg rounded-b-lg font-bold first-of-type:rounded-bl-none last-of-type:rounded-br-none":"")},s.createElement("button",{onClick:e.onClick},e.label))))),R=({className:e})=>{const t=(0,r.rA)(),a=(0,M.Z)("(min-width: 1200px)",!0),[n]=l.S.artistAlley.getCategoriesInUse.useSuspenseQuery(void 0,{refetchInterval:1/0,keepPreviousData:!0}),{loggedIn:o}=(0,L.Pc)(),{data:i}=l.S.artistAlley.hasPurchasedListing.useQuery(void 0,{enabled:o,suspense:!0}),{adultFilterMode:u,setAdultFilterMode:d,categories:m,isAdult:p,categoryMatch:g,setCategoryMatch:f,sortOrder:h,setSortOrder:b}=(0,C.h)();return s.createElement(s.Fragment,null,s.createElement(A.p,{as:"div","data-theme":t.current,className:z.tw`co-themed-box co-artist-alley-filters cohost-shadow-light dark:cohost-shadow-dark col-span-1 flex h-fit max-h-max min-h-0 w-full flex-col rounded-lg border ${e??""}`,defaultOpen:a},s.createElement(A.p.Button,{as:"header",className:"flex flex-row items-center justify-between rounded-t-lg p-3 ui-not-open:rounded-b-lg"},s.createElement(S.Z,{className:"h-5 w-5 ui-open:rotate-90 motion-safe:transition-transform"}),s.createElement("span",{className:"font-league text-xs uppercase"},"filters")),s.createElement(A.p.Panel,{as:"div"},s.createElement("div",{className:"flex flex-row flex-wrap gap-2 px-3 py-2"},n.map((e=>s.createElement("div",{key:`selected-token-${e}`,className:"group h-max cursor-pointer select-none"},s.createElement("button",{className:z.tw`co-token flex items-center justify-start gap-1 rounded-lg px-2 py-1 leading-none ${m.has(e)?"co-active":""}`,onClick:t=>{t.stopPropagation(),m.has(e)?m.delete(e):m.add(e)},type:"button"},s.createElement(I.Z,{className:"inline-block h-3.5"}),s.createElement("span",{className:"block"},e)))))),s.createElement(P,{tabs:[{label:"any",onClick:()=>f("any"),active:"any"===g},{label:"all",onClick:()=>f("all"),active:"all"===g}]}),p&&s.createElement(s.Fragment,null,s.createElement("hr",{className:"border-notWhite"}),s.createElement(P,{tabs:[{label:"hide 18+",onClick:()=>{d("hide")},active:"hide"===u},{label:"show 18+",onClick:()=>{d("include")},active:"include"===u},{label:"only 18+",onClick:()=>{d("only")},active:"only"===u}]})),s.createElement("hr",{className:"border-notWhite"}),s.createElement(P,{tabs:[{label:"random",onClick:()=>{b("random")},active:"random"===h},{label:"newest first",onClick:()=>{b("newest")},active:"newest"===h},{label:"oldest first",onClick:()=>{b("oldest")},active:"oldest"===h}]}))),s.createElement(A.p,{as:"div","data-theme":t.current,className:z.tw`co-themed-box co-artist-alley-filters cohost-shadow-light dark:cohost-shadow-dark col-span-1 mt-4 flex h-fit max-h-max min-h-0 w-full flex-col rounded-lg border ${e??""}`,defaultOpen:a},s.createElement(A.p.Button,{as:"header",className:"flex flex-row items-center justify-between rounded-t-lg p-3 ui-not-open:rounded-b-lg"},s.createElement(S.Z,{className:"h-5 w-5 ui-open:rotate-90 motion-safe:transition-transform"}),s.createElement("span",{className:"font-league text-xs uppercase"},"your listing here!")),s.createElement(A.p.Panel,{as:"div",className:"p-3"},s.createElement("div",{className:"co-prose prose mb-3"},s.createElement("p",null,"are you an artist, musician, game developer, or other creative? got something you want cohost users to know about? get an artist alley listing! only $10 per week!")),s.createElement(j.k,{buttonSize:"regular",buttonColor:"post-box-filled",as:"a",href:c.ZP.public.artistAlley.create().toString(),extraClasses:"mt-2"},"buy a listing"),i&&s.createElement(j.k,{buttonSize:"regular",buttonColor:"post-box-filled",as:"a",href:c.ZP.public.artistAlley.ownerManage().toString(),extraClasses:"mt-2"},"manage your listings"))))};var F=a(26225),O=a(20616);const T=()=>{const{isAdult:e,explicitlyCollapseAdultContent:t}=(0,n.Q)(),[a,l]=o(e?t?"hide":"include":"hide"),[r,i]=o("any"),c=(0,E.$X)(),u=(0,x.useFlag)(h.T.Enum["artist-alley-listings"]),[d,m]=o("random");return s.createElement(C.H.Provider,{value:{adultFilterMode:a,isAdult:e,categories:c,setAdultFilterMode:l,categoryMatch:r,setCategoryMatch:i,sortOrder:d,setSortOrder:m}},s.createElement("div",{className:"styled-scrollbars-light dark:styled-scrollbars-dark styled-scrollbars-light dark:styled-scrollbars-dark container mx-auto flex w-full max-w-full flex-row [height:calc(100vh-4rem)]"},s.createElement(v.ql,{title:"artist alley"}),s.createElement(O.w3,{narrowMode:!0}),u?s.createElement(s.Suspense,{fallback:s.createElement("div",null,"aaaaaaa")},s.createElement(U,null)):s.createElement(_,null)))},_=()=>{const e=(0,r.rA)();return s.createElement("div",{className:"mt-12"},s.createElement("div",{"data-theme":e.current,className:"co-themed-box co-static"},s.createElement("div",{className:"co-prose prose"},s.createElement("h1",null,"artist alley is currently closed"),s.createElement("p",null,"we're still working on getting everything set up! if you're interested in buying a listing, you can do so on the"," ",s.createElement("a",{href:c.vf.public.artistAlley.create().toString()},"sign up page!")),s.createElement("p",null,"artist alley should be live soon. check out"," ",s.createElement("a",{href:"https://cohost.org/staff"},"@staff")," for the most recent info!"))))},U=(u.z.discriminatedUnion("type",[u.z.object({type:u.z.literal("LISTING"),id:d.y1,listing:f,project:b.Fx}),u.z.object({type:u.z.literal("FILTER"),id:u.z.literal("FILTER")})]),()=>{const e=(0,s.useRef)(void 0),{operatingPrime:t}=(0,i.N)(),{adultFilterMode:a,categories:r,categoryMatch:n,sortOrder:o}=(0,C.h)(),[{pages:c},{fetchNextPage:u,fetchStatus:d}]=l.S.artistAlley.getListingsForDisplay.useSuspenseInfiniteQuery({adultDisplayMode:a,categories:Array.from(r),sortModulus:t,categoryMatch:n,sortOrder:o},{getNextPageParam:e=>e.nextCursor,keepPreviousData:!0,refetchInterval:1/0,refetchOnMount:!1,refetchOnReconnect:!1,refetchOnWindowFocus:!1,refetchIntervalInBackground:!1,onError:t=>{w.Am.error(t.message,{id:e.current})},onSuccess:()=>{w.Am.dismiss(e.current)}});(0,s.useEffect)((()=>{"fetching"===d&&(e.current=w.Am.loading("loading listings...",{id:e.current}))}),[d]);const m=(0,s.useMemo)((()=>c.flatMap((e=>e.listings))??[]),[c]),p=(0,s.useMemo)((()=>{const e=new Map;return c.forEach((t=>{Object.values(t.relevantProjects).forEach((t=>{e.set(t.projectId,t)}))})),e}),[c]),g=(0,s.useMemo)((()=>{const e=m.map((e=>{const t=p.get(e.projectId);if(t)return{type:"LISTING",id:e.id,listing:e,project:t}})).filter(y.$);return e.unshift({type:"FILTER",id:"FILTER"}),e}),[m,p]),{ref:f,inView:h}=(0,N.YD)();(0,s.useEffect)((()=>{h&&(0,s.startTransition)((()=>{u()}))}),[h,u]);const b=(0,s.useMemo)((()=>function(e){const t={default:1};for(let e=1;e<=20;e++)t[300*(e+1)]=e;return t[Number.MAX_SAFE_INTEGER]=21,t}()),[]);return s.createElement("div",{className:"flex w-full flex-col gap-4"},s.createElement(k.Z,{breakpointCols:b,className:"artist-alley-grid w-full",columnClassName:"artist-alley-grid_column"},g.map((e=>s.createElement($,{key:e.id,data:e})))),s.createElement("div",{className:"h-[1px] w-[1px] flex-shrink-0",ref:f}))});var D=T;const $=({data:e})=>"LISTING"===e.type?s.createElement("div",{key:e.listing.id,className:"mt-4 inline-block w-full max-w-[300px]"},s.createElement(F.l,{listing:e.listing,project:e.project})):s.createElement("div",{key:e.id,className:"mt-4 inline-block w-full max-w-[300px]"},s.createElement(R,null))}}]);
//# sourceMappingURL=preact-components-pages-artist-alley-artist-alley.1f98bd4bf6e3af5716cd.js.map