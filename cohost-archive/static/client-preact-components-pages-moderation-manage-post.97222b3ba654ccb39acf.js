"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[4316,3549],{2735:function(e,t,l){l.d(t,{Qj:function(){return C},zx:function(){return S}});var r=l(65443),n=l.n(r),a=l(94159),o=l(6285);function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r])}return e},c.apply(this,arguments)}const s=o.z.enum(["pill","roundrect","authn"]),d=o.z.enum(["cherry","strawberry","mango","not-black","red","green","accent","secondary","authn-primary","authn-other"]),m=(o.z.object({buttonStyle:s,color:d,className:o.z.string().optional()}),n()("bg-notWhite","hover:text-notWhite")),u=n()("font-atkinson","font-bold","rounded-full","border-2"),i=n()("body-2","rounded-lg"),b=n()("flex","h-12","items-center","justify-center","rounded-lg","px-6","text-lg"),p=n()("border-cherry","hover:bg-cherry","text-cherry","active:bg-cherry-600","active:border-cherry-600","disabled:text-cherry-300","disabled:border-cherry-300","focus:outline-cherry","focus:ring-cherry",m),g=n()("border-strawberry","hover:bg-strawberry","text-strawberry","active:bg-strawberry-600","active:border-strawberry-600","disabled:text-strawberry-300","disabled:border-strawberry-300","focus:outline-strawberry","focus:ring-strawberry",m),E=n()("border-red","hover:bg-red","text-red","active:bg-red-600","active:border-red-600","disabled:text-red-300","disabled:border-red-300","focus:outline-red",m),f=n()("border-green","hover:bg-green","text-green","active:bg-green-600","active:border-green-600","disabled:text-green-300","disabled:border-green-300","focus:outline-green",m),h=n()("border-mango","hover:bg-mango","text-mango","bg-notBlack","hover:text-notBlack"),v=n()("border-notBlack","hover:bg-notBlack","text-notBlack","focus:outline-notBlack","focus:ring-notBlack",m),x=n()("border-accent","text-accent","bg-foreground","hover:bg-accent","hover:text-text"),y=n()("bg-secondary","text-notWhite","dark:text-notBlack","hover:bg-secondary-600"),w=n()("bg-foreground","text-text","hover:bg-foreground-600","active:bg-foreground-700","disabled:bg-foreground-200"),k=n()("border-2","border-foreground","text-foreground","hover:bg-longan-200"),N=e=>n()("leading-none","align-middle","py-2","px-4","no-select",e.className,{[u]:"pill"===e.buttonStyle,[i]:"roundrect"===e.buttonStyle,[b]:"authn"===e.buttonStyle,[p]:"cherry"===e.color,[g]:"strawberry"===e.color,[h]:"mango"===e.color,[v]:"not-black"===e.color,[E]:"red"===e.color,[x]:"accent"===e.color,[f]:"green"===e.color,[y]:"secondary"===e.color,[w]:"authn-primary"===e.color,[k]:"authn-other"===e.color}),S=a.forwardRef((({buttonStyle:e,color:t,className:l,...r},n)=>{const o=N({buttonStyle:e,color:t,className:l,...r});return a.createElement("button",c({},r,{className:o,ref:n}),r.children)}));S.displayName="Button";const C=a.forwardRef((({buttonStyle:e,color:t,...l},r)=>{const n=N({buttonStyle:e,color:t,...l});return a.createElement("a",c({},l,{className:n,ref:r}),l.children)}));C.displayName="LinkButton"},37147:function(e,t,l){l.r(t),l.d(t,{EditPostForm:function(){return d}});var r=l(94159),n=l(99838),a=l(22018),o=l(71860),c=l(2735);function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r])}return e},s.apply(this,arguments)}const d=({post:e})=>{const t=o.S.posts.moderation.editPost.useMutation(),{control:l,formState:d,register:m,handleSubmit:u}=(0,n.cI)({defaultValues:{postState:e.state,adultContent:e.adultContent,adultContentOverride:e.adultContentOverride,commentsLocked:e.commentsLocked,cws:e.cws}});return(0,r.useEffect)((()=>{d.isSubmitSuccessful&&location.reload()}),[d.isSubmitSuccessful]),r.createElement("form",{className:"my-6 flex max-w-prose flex-col gap-4 divide-y",onSubmit:u((l=>t.mutateAsync({postId:e.postId,adultContent:l.adultContent,adultContentOverride:l.adultContentOverride,state:l.postState,commentsLocked:l.commentsLocked,cws:l.cws})))},r.createElement("div",{className:"flex flex-col gap-2"},r.createElement("label",null,"post state"),d.errors.postState?r.createElement("span",{className:"font-bold text-red"},d.errors.postState.message):null,r.createElement("select",m("postState",{valueAsNumber:!0}),r.createElement("option",{value:a.h.Deleted},"Deleted"),r.createElement("option",{value:a.h.Unpublished},"Unpublished"),r.createElement("option",{value:a.h.Published},"Published"))),r.createElement("div",{className:"flex flex-col gap-2"},r.createElement("div",{className:"flex flex-row items-center gap-2"},r.createElement("label",null,"adult content"),r.createElement("input",s({type:"checkbox"},m("adultContent")))),d.errors.adultContent?r.createElement("span",{className:"font-bold text-red"},d.errors.adultContent.message):null),r.createElement("div",{className:"flex flex-col gap-2"},r.createElement("div",{className:"flex flex-row items-center gap-2"},r.createElement("label",null,"adult content override"),r.createElement("input",s({type:"checkbox"},m("adultContentOverride")))),d.errors.adultContentOverride?r.createElement("span",{className:"font-bold text-red"},d.errors.adultContentOverride.message):null),r.createElement("div",{className:"flex flex-col gap-2"},r.createElement("div",{className:"flex flex-row items-center gap-2"},r.createElement("label",null,"comments locked"),r.createElement("input",s({type:"checkbox"},m("commentsLocked")))),d.errors.commentsLocked?r.createElement("span",{className:"font-bold text-red"},d.errors.commentsLocked.message):null),r.createElement("div",{className:"flex flex-col gap-2"},r.createElement("div",{className:"flex flex-row items-center gap-2"},r.createElement("label",null,"CWs"),r.createElement("input",s({className:"w-full"},m("cws",{setValueAs:e=>"string"==typeof e?e.split(",").map((e=>e.trim())):e})))),d.errors.cws?r.createElement("span",{className:"font-bold text-red"},d.errors.cws.map((e=>e.message)).join(", ")):null),r.createElement(c.zx,{type:"submit",buttonStyle:"pill",color:"cherry",className:"max-w-max"},"submit"),d.isSubmitSuccessful?r.createElement("span",{className:"font-bold text-green"},"Submit successful!"):null,null)}},30254:function(e,t,l){l.r(t);var r=l(22233),n=l(12093),a=l(85771),o=l(22018),c=l(84879),s=l(94159),d=l(77378),m=l(39975),u=l(37147);const i=({value:e})=>void 0===e?s.createElement(s.Fragment,null,"❓"):e?s.createElement(s.Fragment,null,"✅"):s.createElement(s.Fragment,null,"❌"),b=({blocks:e,hasCohostPlus:t,effectiveDate:l})=>{const n=(0,s.useMemo)((()=>e.filter(a.E4)),[e]),o=(0,d.Z)((()=>(0,r.e8)(n,new Date,{hasCohostPlus:t,renderingContext:"post"})),[e,t]);return s.createElement("div",{"data-post-preview":!0,className:"cohost-shadow-light rounded-lg bg-white"},o.loading?s.createElement("div",{className:"text-notBlack"},"rendering..."):o.error?s.createElement("div",{className:"text-notBlack"},o.error.message):s.createElement(m.y,{viewModel:{postId:0,blocks:n,astMap:o.value},skipCollapse:!0,effectiveDate:l}))};t.default=e=>{const{post:t,logEntries:l,postingProject:r,viewModel:a}=e,d=(0,s.useMemo)((()=>t.transparentShareOfPostId?"transparent share":t.shareOfPostId?"contentful share":"original"),[t.shareOfPostId,t.transparentShareOfPostId]),[m,p]=(0,s.useState)([]);return s.createElement("div",{className:"cohost-shadow-light dark:cohost-shadow-dark flex min-w-0 max-w-full flex-col gap-4 rounded-lg bg-notWhite\n            p-3 text-notBlack"},s.createElement("h1",{className:"text-4xl font-bold"},"manage post"),s.createElement("em",null,"all times local to your browser"),s.createElement("div",null,s.createElement("h2",{className:"text-2xl font-bold"},"details"),s.createElement("div",{className:"prose"},s.createElement("ul",null,s.createElement("li",null,"post id: ",t.postId," (",s.createElement("a",{href:a.singlePostPageUrl,target:"post"},"permalink"),")"),s.createElement("li",null,"type: ",d),s.createElement("li",null,"published at:"," ",t.publishedAt?c.ou.fromISO(t.publishedAt).toLocaleString(c.ou.DATETIME_MED):"none"),s.createElement("li",null,"headline: ",t.headline),s.createElement("li",null,"posted by: @",r.handle,s.createElement("ul",null,s.createElement("li",null,s.createElement("a",{href:n.ZP.public.project.mainAppProfile({projectHandle:r.handle}).toString(),target:"profile"},"profile")),s.createElement("li",null,s.createElement("a",{href:n.ZP.public.moderation.manageProject({projectHandle:r.handle}).toString(),target:"managePage"},"manage")))),a.responseToAskId&&s.createElement("li",null,"response to ask:"," ",s.createElement("a",{href:n.ZP.public.moderation.manageAsk({askId:a.responseToAskId}).toString(),target:"_blank",rel:"noopener noreferrer"},a.responseToAskId))))),s.createElement("div",{className:"rounded-lg border p-3"},s.createElement("h2",{className:"text-2xl font-bold"},"audit log"),l.length?s.createElement("div",{className:"relative overflow-auto"},s.createElement("table",{className:"prose w-full prose-tr:border-b prose-td:whitespace-nowrap"},s.createElement("thead",null,s.createElement("th",null,"logged at"),s.createElement("th",null,"headline"),s.createElement("th",null,"blocks"),s.createElement("th",null,"adult content"),s.createElement("th",null,"adult content override"),s.createElement("th",null,"cws"),s.createElement("th",null,"state"),s.createElement("th",null,"comments locked")),l.map((e=>s.createElement("tr",{key:e.entryId},s.createElement("td",null,s.createElement("span",null,c.ou.fromISO(e.loggedAt).toLocaleString(c.ou.DATETIME_MED))),s.createElement("td",null,JSON.stringify(e.oldHeadline),s.createElement("br",null),"➡️",s.createElement("br",null),JSON.stringify(e.newHeadline)),s.createElement("td",null,s.createElement("a",{onClick:()=>p(e.oldBlocks),href:"#post-preview"},"preview old"),s.createElement("br",null),s.createElement("a",{onClick:()=>p(e.newBlocks),href:"#post-preview"},"preview new")),s.createElement("td",null,s.createElement(i,{value:e.oldAdultContent})," ","➡️"," ",s.createElement(i,{value:e.newAdultContent})),s.createElement("td",null,s.createElement(i,{value:e.oldAdultContentOverride})," ","➡️"," ",s.createElement(i,{value:e.newAdultContentOverride})),s.createElement("td",null,s.createElement("code",null,JSON.stringify(e.oldCws)),s.createElement("br",null),"➡️",s.createElement("br",null),s.createElement("code",null,JSON.stringify(e.newCws))),s.createElement("td",null,o.h[e.oldState]," ➡️"," ",o.h[e.newState]),s.createElement("td",null,s.createElement(i,{value:e.oldCommentsLocked})," ","➡️"," ",s.createElement(i,{value:e.newCommentsLocked}))))))):s.createElement("p",null,"this post has never been edited")),s.createElement("div",{className:"flex flex-col gap-4 rounded-lg border p-3",id:"post-preview"},s.createElement("h2",{className:"text-2xl font-bold"},"preview markdown blocks"),m.length?s.createElement(s.Fragment,null,s.createElement(b,{blocks:m,hasCohostPlus:t.hasCohostPlus,effectiveDate:t.publishedAt}),s.createElement("div",{className:"prose"},s.createElement("details",null,s.createElement("summary",null,"code"),s.createElement("pre",null,s.createElement("code",null,JSON.stringify(m,null,2)))))):s.createElement("p",null,"nothing to show")),s.createElement("div",{className:"rounded-lg border p-3"},s.createElement("h2",{className:"text-2xl font-bold"},"edit post"),s.createElement(u.EditPostForm,{post:t})))}}}]);
//# sourceMappingURL=client-preact-components-pages-moderation-manage-post.97222b3ba654ccb39acf.js.map