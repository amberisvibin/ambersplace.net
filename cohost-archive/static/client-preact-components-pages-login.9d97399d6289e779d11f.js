"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[2706],{21161:function(e,t,a){var n=a(94159);t.Z=function(e){var t=e.children,a=e.fallback,l=void 0===a?null:a,r=n.useState(!1),s=r[0],o=r[1];return n.useEffect((function(){return o(!0)}),[]),s?t:l}},68248:function(e,t,a){a.d(t,{Z:function(){return n}});class n{static async getSalt(e){const t=new URL("/api/v1/login/salt",document.URL);return t.searchParams.append("email",e),(await fetch(t.toString()).then((e=>e.json().then((e=>e))))).salt}static async hashPasswordInWorker(e,t,n){const l=new Worker(new URL(a.p+a.u(3639),a.b));return new Promise((a=>{l.onmessage=e=>{a(e.data.clientHash)},l.postMessage({email:e,password:n,salt:t})}))}}},72228:function(e,t,a){a.d(t,{F:function(){return u}});var n=a(97244),l=a(34377),r=a(65443),s=a.n(r),o=a(94159),i=a(99838);function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},c.apply(this,arguments)}const u=({style:e="light",showValidity:t=!0,name:a,control:r,rules:u,trigger:m,...d})=>{const{field:g,fieldState:p}=(0,i.bc)({name:a,control:r,rules:u}),{name:f,onChange:h}=g,[y,b]=(0,o.useState)();(0,o.useEffect)((()=>{g.ref(y)}),[y,g]);const{inputStyleClasses:v,contentDivStyleClasses:E,validityIconStyleClasses:w}=(0,o.useMemo)((()=>{switch(e){case"light":return{inputStyleClasses:"border-gray-600 text-notBlack\n                        placeholder:text-gray-600\n                        focus:border-notBlack disabled:border-gray-300",contentDivStyleClasses:"to-notWhite",validityIconStyleClasses:"bg-notWhite"};case"dynamic":return{inputStyleClasses:"co-styled-input",contentDivStyleClasses:"co-styled-input-content",validityIconStyleClasses:"co-styled-input-validity-icon"};default:return{inputStyleClasses:"border-gray-400 text-notWhite \n                        placeholder:text-gray-400\n                        focus:border-notWhite read-only:bg-gray-700",contentDivStyleClasses:"to-notBlack",validityIconStyleClasses:"bg-notBlack"}}}),[e]);return(0,o.useEffect)((()=>{y&&y.value&&y.value!==d.defaultValue&&y.value!==g.value&&!p.isTouched&&(h(y.value),m(f,{shouldFocus:!0}))}),[y,g.value,f,p.isTouched,h,d.defaultValue,m]),o.createElement("div",{className:"relative"},o.createElement("input",c({className:s()("\n                        w-full min-w-[15rem] rounded-lg border-2 bg-transparent\n                    ",v)},d,g,{ref:b})),t&&!d.readOnly&&p.isTouched?o.createElement(o.Fragment,null,o.createElement("div",{className:s()("\n                                absolute bottom-0 right-9 top-0 my-auto h-6 w-3 \n                                bg-gradient-to-r from-transparent\n                            ",E)}),p.invalid?o.createElement(n.Z,{className:s()("\n                                    absolute bottom-0 right-3 top-0 my-auto h-6 \n                                    w-6 text-red\n                                ",w)}):o.createElement(l.Z,{className:s()("\n                                    absolute bottom-0 right-3 top-0 my-auto h-6\n                                    w-6 bg-notWhite text-green\n                                ",w)})):null)}},46538:function(e,t,a){a.r(t),a.d(t,{Login:function(){return v},default:function(){return E}});var n=a(12093),l=a(87836),r=a(94159),s=a(90275),o=a(51028),i=a(70069),c=a(71860),u=a(7449),m=a(36612),d=a(21161),g=a(99838),p=a(6285),f=a(68248),h=a(6553),y=a(28922),b=({redirectTo:e="/"})=>{const{t:t}=(0,o.$G)(),[a,l]=(0,r.useState)(!1),[s,i]=(0,r.useState)(""),{handleSubmit:b,control:v,formState:{errors:E},trigger:w}=(0,g.cI)({mode:"onTouched"}),S=(0,u.I)(),x=c.S.login.login.useMutation({onError:()=>{i("Couldn't login! Check your e-mail and password."),l(!1)}});return r.createElement(d.Z,{fallback:r.createElement("div",{className:"prose prose-invert text-notWhite"},r.createElement("p",null,"Loading..."),r.createElement("p",null,"If you keep seeing this, try refreshing!"))},r.createElement("form",{className:"flex flex-col gap-4",id:"login-form",onSubmit:b((async({email:t,password:a})=>{l(!0),i("");const n=await S.login.getSalt.query({email:t}),r=await f.Z.hashPasswordInWorker(t,n.salt,a);switch((await x.mutateAsync({email:t,clientHash:r})).state){case"need-otp":location.reload();break;case"done":location.replace(e)}}))},r.createElement("h1",{className:"text-xl capitalize"},t("common:login")),s?r.createElement("div",{className:"max-w-prose rounded-lg border-red-500 bg-red-300 p-3 text-notBlack"},s):null,r.createElement("div",{className:"flex flex-col gap-2"},r.createElement("label",null,r.createElement("div",{className:"my-2 text-lg"},t("client:register.email.label")),r.createElement(y.y,{trigger:w,type:"email",autoComplete:"email",name:"email","data-testid":"email",rules:{required:t("client:register.email.required","E-mail can't be empty!").toString(),validate:e=>p.z.string().email().safeParse(e).success},control:v})),r.createElement("p",{className:"text-red",role:"alert"},E.email?E.email.message:null)),r.createElement("div",{className:"flex flex-col gap-2"},r.createElement("label",null,r.createElement("div",{className:"my-2 text-lg"},t("common:password")),r.createElement(y.y,{trigger:w,type:"password",autoComplete:"current-password",name:"password","data-testid":"password",rules:{required:t("client:register.password.required").toString(),minLength:{value:8,message:t("client:register.password.min-length").toString()}},control:v})),r.createElement("p",{className:"text-red",role:"alert"},E.password?E.password.message:null)),r.createElement(h.p,{type:"submit",disabled:a},t("common:login"))),r.createElement("a",{href:n.vf.public.resetPassword({}).toString(),className:"flex items-center gap-1 capitalize text-mango hover:underline"},r.createElement(m.Z,{className:"h-6 w-6"}),"forgot your password?"))};const v=({redirectTo:e})=>{const{t:t}=(0,o.$G)();return r.createElement(r.Fragment,null,r.createElement(s.ql,{title:"login"}),r.createElement(i.L,{className:"-ml-6 text-notWhite lg:-ml-12"}),r.createElement(b,{redirectTo:e}),r.createElement("a",{href:n.ZP.public.welcome().toString(),className:"flex items-center gap-1 capitalize text-mango hover:underline"},r.createElement(l.Z,{className:"h-6 w-6"}),t("common:back-button")))};v.displayName="login";var E=v},28922:function(e,t,a){a.d(t,{y:function(){return s}});var n=a(94159),l=a(72228);function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},r.apply(this,arguments)}const s=({...e})=>n.createElement(l.F,r({style:"dark"},e))},87836:function(e,t,a){var n=a(94159);const l=n.forwardRef((function({title:e,titleId:t,...a},l){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:l,"aria-labelledby":t},a),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18.75 19.5l-7.5-7.5 7.5-7.5m-6 15L5.25 12l7.5-7.5"}))}));t.Z=l}}]);
//# sourceMappingURL=client-preact-components-pages-login.9d97399d6289e779d11f.js.map